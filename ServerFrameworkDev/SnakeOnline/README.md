# TCP 编程 项目试验 -- 贪吃蛇 联机版

## 一、实验目的

1. 掌握TCP协议基础：理解TCP/IP模型、数据传输流程、三次握手和四次挥手过程。
2. 掌握Go语言TCP编程：掌握net、bufio和io包的使用。
3. 理解和解决TCP粘包问题：理解TCP协议的特性以及如何通过应用层自定义协议解决粘包问题。

## 二、实验仪器设备或材料

1. 计算机：运行Windows、Linux或macOS操作系统的计算机。
2. Go语言环境：已安装并配置好Go语言环境，包括GOPATH、GOROOT等环境变量的设置。
3. 文本编辑器或IDE：如VS Code、GoLand等，用于编写Go代码。
4. 网络连接：用于下载相关库和依赖。

## 三、实验原理

本次实验基于 TCP 协议，利用其面向连接、可靠传输的特性，使用 Go 语言的 net 包构建多人在线贪吃蛇对战游戏。客户端通过 TCP 连接将游戏状态实时发送给服务器，服务器负责广播给其他客户端，同时解决 TCP 粘包问题，保证游戏数据的准确性和实时性。

## 四、实验内容与步骤

1. 建立TCP连接
   1. 编写服务端代码，使用net.Listen函数监听指定端口，并使用net.Accept函数接受客户端连接。
   2. 编写客户端代码，使用net.Dial函数连接到服务器。
2. 定义玩家数据结构
   1. 定义一个Player结构体，包含玩家的位置、大小、等信息。
   2. 使用JSON格式序列化和反序列化玩家数据，方便网络传输。
3. 实现客户端消息发送和接收
   1. 客户端在每次更新玩家位置后，将玩家数据序列化为JSON 字符串。直接通过conn.Write发送给服务器。
   2. 客户端启动一个Goroutine监听来自服务器的消息，直接通过conn.Read读取消息，根据不同的消息类型做相应处理。
4. 实现服务端的消息接收和广播
   1. 服务端接收客户端发送的消息，根据消息类型做相应的处理。
   2. 将收到的消息或食物消息广播给其他客户端。
5. 处理食物同步
   1. 服务器随机生成食物位置。
   2. 服务器将食物位置信息广播给所有客户端。
   3. 客户端接收到消息后，更新本地食物坐标。
6. 解决TCP粘包问题
   1. 定义消息帧结构（包含消息长度、消息类型和数据）。
   2. 修改客户端和服务端的消息发送和接受逻辑，使用WriteFrame和ReadFrame函数进行消息的发送和接收。
